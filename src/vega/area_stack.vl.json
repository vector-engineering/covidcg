{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "data": {
    "name": "case_data",
    "format": {
      "type": "json",
      "parse": {
        "date": "number",
        "cases_sum": "number"
      }
    }
  },
  "vconcat": [
    {
      "width": "container",
      "height": 300,
      "mark": "area",
      "selection": {
        "highlight": {
          "type": "single",
          "empty": "all",
          "on": "mouseover",
          "encodings": ["color"]
        }
      },
      "encoding": {
        "x": {
          "field": "date",
          "type": "temporal",
          "scale": {
            "domain": {
              "selection": "brush"
            }
          },
          "axis": {
            "title": null,
            "grid": true
          }
        },
        "y": {
          "field": "cases_sum",
          "type": "quantitative",
          "axis": {
            "title": "Cases by Group"
          }
        },
        "color": {
          "field": "group",
          "type": "nominal",
          "scale": { "scheme": "tableau20" },
          "legend": null
        },
        "opacity": {
          "condition": { "selection": "highlight", "value": 1 },
          "value": 0.8
        },
        "tooltip": [
          {
            "field": "group",
            "title": "Group",
            "type": "nominal"
          },
          {
            "field": "date",
            "title": "Sample Date",
            "type": "temporal",
            "timeUnit": "monthdate"
          },
          {
            "field": "cases_sum",
            "title": "Cases",
            "type": "quantitative"
          }
        ]
      }
    },
    {
      "width": "container",
      "height": 50,
      "mark": "bar",
      "encoding": {
        "x": {
          "field": "date",
          "type": "temporal",
          "axis": {
            "tickCount": "week",
            "title": "Sample Date",
            "labelAlign": "left",
            "labelExpr": "[timeFormat(datum.value, '%b'), timeFormat(datum.value, '%d')]",
            "labelOffset": 4,
            "labelPadding": -24,
            "tickSize": 30
          }
        },
        "y": {
          "aggregate": "sum",
          "field": "cases_sum",
          "type": "quantitative",
          "axis": {
            "title": "All Cases"
          }
        },
        "fill": {
          "condition": {
            "selection": "brush",
            "value": "blue"
          },
          "value": "red"
        }
      },
      "selection": {
        "brush": {
          "type": "interval",
          "encodings": ["x"]
        }
      }
    }
  ],
  "config": {
    "concat": {
      "spacing": 0
    },
    "bar": {
      "continuousBandSize": 8
    }
  }
}
